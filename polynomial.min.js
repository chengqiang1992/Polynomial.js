/*
 Polynomial.js v1.3.0 11/12/2017

 Copyright (c) 2015, Robert Eisele (robert@xarg.org)
 Dual licensed under the MIT or GPL Version 2 licenses.
*/
(function(u){function x(a){return function(){var c=this.coeff,b=[];for(e in c)b.push(+e);if(0===b.length)return"0";b.sort(function(a,d){return a-d});for(var d,f="",p=b.length;p--;){var e=b[p];var k=c[e];d=k;if(null!==d&&void 0!==d)if(l&&d instanceof l){if(0!==d.re){""!==f&&0<d.re&&(f+="+");if(-1===d.re&&0!==e)f+="-";else if(1!==d.re||0===e)f+=d.re;1===e?f+="x":0!==e&&(f+="x^"+e)}0!==d.im&&(""!==f&&0<d.im&&(f+="+"),-1===d.im?f+="-":1!==d.im&&(f+=d.im),f+="i",1===e?f+="x":0!==e&&(f+="x^"+e))}else if(d=
d.valueOf(),0!==d){""!==f&&0<d&&(f+="+");if(-1===d&&0!==e)f+="-";else if(1!==d||0===e)f+=k[a]?k[a]():k.toString();1===e?f+="x":0!==e&&(f+="x^"+e)}}return""===f?k[a]?k[a]():k.toString():f}}function m(a){var c={};if(null===a||void 0===a)a=0;switch(typeof a){case "object":a.coeff&&(a=a.coeff);if(q&&a instanceof q||l&&a instanceof l||r&&a instanceof r)c[0]=a;else for(var b in a)g.empty(a[b])||(c[b]=g.parse(a[b]));return c;case "number":return{0:g.parse(a)};case "string":for(var d,f;null!==(b=C.exec(a));){f=
d=1;void 0!==b[4]?(d=b[4],f=0):void 0!==b[2]&&(d=b[2]);var e=b[1];d=String(d).match(/[^*/]+|[*/]/g);e=g.parse(e+d[0]);for(var h=1;h<d.length;h+=2)"*"===d[h]?e=g.mul(e,g.parse(d[h+1]||1)):"/"===d[h]&&(e=g.div(e,g.parse(d[h+1]||1)));d=e;void 0!==b[3]&&(f=parseInt(b[3],10));c[f]=void 0===c[f]?d:g.add(c[f],d)}return c}throw"Invalid Param";}function w(a,c){for(var b={},d=n(a),f=n(c),p=[];d>=f;){var h=b[d-f]=g.div(a[d]||0,c[f]||0),k;for(k in c)a[+k+d-f]=g.sub(a[+k+d-f]||0,g.mul(c[k]||0,h));if(null!==e.trace){var y=
{};for(k in c)y[+k+d-f]=g.mul(c[k]||0,h);p.push(new e(y))}d=n(a)}null!==e.trace&&(p.push(new e(a)),e.trace=p);return b}function z(a,c){var b=1;for(c=a-c;c<a;a--)b*=a;return b}function e(a){if(!(this instanceof e))return new e(a);this.coeff=m(a)}function t(a){var c={},b;for(b in a)c[b]=a[b];return c}function A(a,c){var b={},d;for(d in a)b[d]=1;for(d in c)b[d]=1;return b}function n(a){var c=Number.NEGATIVE_INFINITY,b;for(b in a)g.empty(a[b])||(c=Math.max(b,c));return c}function v(a){var c=null,b;for(b in a)!g.empty(a[b])&&
(null===c||+c<+b)&&(c=b);return c}function B(a,c){if(null!==c)for(var b in a)a[b]=g.div(a[b],a[c]);return a}var g={add:function(a,c){return a+c},sub:function(a,c){return a-c},mul:function(a,c){return a*c},div:function(a,c){if(0===c)throw"DIV/0";return a/c},parse:function(a){return parseFloat(a)},empty:function(a){return!a},pow:function(a,c){return Math.pow(a,c)}},D=g,C=/([+-]?)(?:([^+x-]+)?(?:x(?:\^([\d\/]+))?)|([^+x-]+))/g;e.trace=null;e.prototype.coeff={};e.prototype.gcd=function(a){var c=t(this.coeff);
for(a=m(a);n(a)!==Number.NEGATIVE_INFINITY;){var b=t(c);w(b,a);c=a;a=b}a=v(c);return new e(B(c,a))};e.prototype.neg=function(){var a={},c=this.coeff,b;for(b in c)a[b]=g.mul(c[b],-1);return new e(a)};e.prototype.reciprocal=function(){var a={},c=this.coeff,b=n(c),d;for(d in c)a[b-d]=c[d];return new e(a)};e.prototype.eval=function(a){var c=this.coeff,b=n(c),d=c[b];for(--b;0<=b;b--)d=g.mul(d,a),g.empty(c[b])||(d=g.add(d,c[b]));return d};e.prototype.lc=function(){var a=v(this.coeff);return this.coeff[a]};
e.prototype.lm=function(){var a=v(this.coeff),c={};c[a]=this.coeff[a];return new e(c)};e.prototype.monic=function(){return new e(B(t(this.coeff),v(this.coeff)))};e.prototype.add=function(a){a=m(a);var c={},b=this.coeff,d=A(a,b),f;for(f in d)c[f]=g.add(b[f]||0,a[f]||0);return new e(c)};e.prototype.sub=function(a){a=m(a);var c={},b=this.coeff,d=A(a,b),f;for(f in d)c[f]=g.sub(b[f]||0,a[f]||0);return new e(c)};e.prototype.mul=function(a){a=m(a);var c={},b=this.coeff;for(d in a){var d=+d;for(var f in b)f=
+f,c[d+f]=g.add(c[d+f]||0,g.mul(a[d]||0,b[f]||0))}return new e(c)};e.prototype.addmul=function(a,c){var b=m(a),d=m(c),f={};for(e in b){var e=+e;for(var h in d)h=+h,f[e+h]=g.add(f[e+h]||0,g.mul(b[e]||0,d[h]||0))}return this.add(f)};e.prototype.div=function(a){return new e(w(t(this.coeff),m(a)))};e.prototype.pow=function(a){if(isNaN(a)||0>a||a%1)throw"Invalid";for(var c=new e(1),b=this;0<a;)a&1&&(c=c.mul(b)),b=b.mul(b),a>>=1;return c};e.prototype.mod=function(a){var c=t(this.coeff);w(c,m(a));return new e(c)};
e.prototype.derive=function(a){if(void 0===a)a=1;else if(0>a)return null;var c=this.coeff,b={},d;for(d in c)+d>=a&&(b[d-a]=g.mul(c[d]||0,z(+d,a)));return new e(b)};e.prototype.integrate=function(a){if(void 0===a)a=1;else if(0>a)return null;var c=this.coeff,b={},d;for(d in c)b[+d+a]=g.div(c[d]||0,z(+d+a,a));return new e(b)};e.prototype.result=e.prototype.eval;e.prototype.toString=x("toString");e.prototype.toLatex=x("toLatex");e.prototype.toHorner=function(){function a(a,d){var b="";l&&a instanceof
l?0===a.im?(0<a.re&&d&&(b+="+"),b+=a.re):0===a.re?(-1===a.im?b+="-":1!==a.im?(0<a.im&&d&&(b+="+"),b+=a.im):0<a.im&&d&&(b+="+"),b+="i"):(d&&(b+="+"),b=b+"("+a.toString(),b+=")"):(0<a&&d&&(b+="+"),b+=a.toString());return b}function c(d,e){var f=d.length-e-1,g=d[f]-(d[f-1]||0),h="",p="";0<g&&(h="x",1<g&&(h+="^"+g));0<f&&(h+=a(b[d[f-1]],!0));if(0===e)return a(b[d[f]],!1)+h;0<=f&&d[f]&&(p+="(");p+=c(d,e-1);0<=f&&d[f]&&(p+=")");return p+h}var b=this.coeff,d=[],e;for(e in b)g.empty(b[e])||d.push(+e);if(0===
d.length)return"0";d.sort(function(a,d){return a-d});return c(d,d.length-1)};e.prototype.clone=function(){return new e(this)};e.prototype.degree=function(){return n(this.coeff)};e.setField=function(a){var c={Q:q,C:l,H:r}[a];if(void 0!==c)g={add:function(a,b){return(new c(a)).add(b)},sub:function(a,b){return(new c(a)).sub(b)},mul:function(a,b){return(new c(a)).mul(b)},div:function(a,b){return(new c(a)).div(b)},parse:function(a){return new c(a)},empty:function(a){return(new c(a)).equals(0)},pow:function(a,
b){return(new c(a)).pow(b)}};else if(!a||"R"===a)g=D;else if("object"===typeof a)g=a;else if("Z"===a.charAt(0)){var b=+a.slice(1);g={add:function(a,c){return((a+c)%b+b)%b},sub:function(a,c){return((a-c)%b+b)%b},mul:function(a,c){return(a*c%b+b)%b},div:function(a,c){var d=c;for(var e=b,f=0,g=1,l=1,m=0;0!==d;){var n=e/d|0,q=e%d,r=f-l*n;n=g-m*n;e=d;d=q;f=l;g=m;l=r;m=n}d=[e,f,g];if(1!==d[0])throw"DIV/-";return(a*d[1]%b+b)%b},parse:function(a){return parseInt(a,10)},empty:function(a){return void 0===a||
0===a},pow:function(a,c){for(var d=1;0<c;a=(a*a%b+b)%b,c>>=1)c&1&&(d=(d*a%b+b)%b);return d}}}};if("function"===typeof define&&define.amd)define(["fraction.js","complex.js","quaternion"],function(a,c,b){q=a;l=c;r=b;return e});else if("object"===typeof exports){var q=require("fraction.js");var l=require("complex.js");var r=require("quaternion");module.exports=e}else q=u.Fraction,l=u.Complex,r=u.Quaternion,u.Polynomial=e})(this);