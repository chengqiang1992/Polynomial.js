/*
 Polynomial.js v1.2.2 11/12/2017

 Copyright (c) 2015, Robert Eisele (robert@xarg.org)
 Dual licensed under the MIT or GPL Version 2 licenses.
*/
(function(t){function x(a){return function(){var d=this.coeff,c=[];for(h in d)c.push(+h);if(0===c.length)return"0";c.sort(function(c,a){return c-a});for(var b,f="",e=c.length;e--;){var h=c[e];var l=d[h];b=l;if(null!==b&&void 0!==b)if(k&&b instanceof k){if(0!==b.re){""!==f&&0<b.re&&(f+="+");if(-1===b.re&&0!==h)f+="-";else if(1!==b.re||0===h)f+=b.re;1===h?f+="x":0!==h&&(f+="x^"+h)}0!==b.im&&(""!==f&&0<b.im&&(f+="+"),-1===b.im?f+="-":1!==b.im&&(f+=b.im),f+="i",1===h?f+="x":0!==h&&(f+="x^"+h))}else if(b=
b.valueOf(),0!==b){""!==f&&0<b&&(f+="+");if(-1===b&&0!==h)f+="-";else if(1!==b||0===h)f+=l[a]?l[a]():l.toString();1===h?f+="x":0!==h&&(f+="x^"+h)}}return""===f?l[a]?l[a]():l.toString():f}}function p(a){var d={};if(null===a||void 0===a)a=0;switch(typeof a){case "object":a.coeff&&(a=a.coeff);if(m&&a instanceof m||k&&a instanceof k||n&&a instanceof n)d[0]=a;else for(var c in a)g.empty(a[c])||(d[c]=g.parse(a[c]));return d;case "number":return{0:g.parse(a)};case "string":for(var b,f;null!==(c=B.exec(a));){f=
b=1;void 0!==c[4]?(b=c[4],f=0):void 0!==c[2]&&(b=c[2]);var e=c[1];b=String(b).match(/[^*/]+|[*/]/g);e=g.parse(e+b[0]);for(var h=1;h<b.length;h+=2)"*"===b[h]?e=g.mul(e,g.parse(b[h+1]||1)):"/"===b[h]&&(e=g.div(e,g.parse(b[h+1]||1)));b=e;void 0!==c[3]&&(f=parseInt(c[3],10));d[f]=void 0===d[f]?b:g.add(d[f],b)}return d}throw"Invalid Param";}function w(a,d){for(var c={},b=q(a),f=q(d),v=[];b>=f;){var h=c[b-f]=g.div(a[b]||0,d[f]||0),l;for(l in d)a[+l+b-f]=g.sub(a[+l+b-f]||0,g.mul(d[l]||0,h));if(null!==e.trace){var k=
{};for(l in d)k[+l+b-f]=g.mul(d[l]||0,h);v.push(new e(k))}b=q(a)}null!==e.trace&&(v.push(new e(a)),e.trace=v);return c}function y(a,d){var c=1;for(d=a-d;d<a;a--)c*=a;return c}function e(a){if(!(this instanceof e))return new e(a);this.coeff=p(a)}function r(a){var d={},c;for(c in a)d[c]=a[c];return d}function z(a,d){var c={},b;for(b in a)c[b]=1;for(b in d)c[b]=1;return c}function q(a){var d=Number.NEGATIVE_INFINITY,c;for(c in a)g.empty(a[c])||(d=Math.max(c,d));return d}function u(a){var d=null,c;for(c in a)!g.empty(a[c])&&
(null===d||+d<+c)&&(d=c);return d}function A(a,d){if(null!==d)for(var c in a)a[c]=g.div(a[c],a[d]);return a}var g={add:function(a,d){return a+d},sub:function(a,d){return a-d},mul:function(a,d){return a*d},div:function(a,d){if(0===d)throw"DIV/0";return a/d},parse:function(a){return parseFloat(a)},empty:function(a){return!a},pow:function(a,d){return Math.pow(a,d)}},C=g,B=/([+-]?)(?:([^+x-]+)?(?:x(?:\^([\d\/]+))?)|([^+x-]+))/g;e.trace=null;e.prototype.coeff={};e.prototype.gcd=function(a){var d=r(this.coeff);
for(a=p(a);q(a)!==Number.NEGATIVE_INFINITY;){var c=r(d);w(c,a);d=a;a=c}a=u(d);return new e(A(d,a))};e.prototype.neg=function(){var a={},d=this.coeff,c;for(c in d)a[c]=g.mul(d[c],-1);return new e(a)};e.prototype.reciprocal=function(){var a={},d=this.coeff,c=q(d),b;for(b in d)a[c-b]=d[b];return new e(a)};e.prototype.eval=function(a){var d=this.coeff,c=q(d),b=d[c];for(--c;0<=c;c--)b=g.mul(b,a),g.empty(d[c])||(b=g.add(b,d[c]));return b};e.prototype.lc=function(){var a=u(this.coeff);return this.coeff[a]};
e.prototype.lm=function(){var a=u(this.coeff),d={};d[a]=this.coeff[a];return new e(d)};e.prototype.monic=function(){return new e(A(r(this.coeff),u(this.coeff)))};e.prototype.add=function(a){a=p(a);var d={},c=this.coeff,b=z(a,c),f;for(f in b)d[f]=g.add(c[f]||0,a[f]||0);return new e(d)};e.prototype.sub=function(a){a=p(a);var d={},c=this.coeff,b=z(a,c),f;for(f in b)d[f]=g.sub(c[f]||0,a[f]||0);return new e(d)};e.prototype.mul=function(a){a=p(a);var d={},c=this.coeff;for(b in a){var b=+b;for(var f in c)f=
+f,d[b+f]=g.add(d[b+f]||0,g.mul(a[b]||0,c[f]||0))}return new e(d)};e.prototype.addmul=function(a,d){var c=p(a),b=p(d),f={};for(e in c){var e=+e;for(var h in b)h=+h,f[e+h]=g.add(f[e+h]||0,g.mul(c[e]||0,b[h]||0))}return this.add(f)};e.prototype.div=function(a){return new e(w(r(this.coeff),p(a)))};e.prototype.pow=function(a){if(isNaN(a)||0>a||a%1)throw"Invalid";for(var d=new e(1),c=this;0<a;)a&1&&(d=d.mul(c)),c=c.mul(c),a>>=1;return d};e.prototype.mod=function(a){var d=r(this.coeff);w(d,p(a));return new e(d)};
e.prototype.derive=function(a){if(void 0===a)a=1;else if(0>a)return null;var d=this.coeff,c={},b;for(b in d)+b>=a&&(c[b-a]=g.mul(d[b]||0,y(+b,a)));return new e(c)};e.prototype.integrate=function(a){if(void 0===a)a=1;else if(0>a)return null;var d=this.coeff,c={},b;for(b in d)c[+b+a]=g.div(d[b]||0,y(+b+a,a));return new e(c)};e.prototype.result=e.prototype.eval;e.prototype.toString=x("toString");e.prototype.toLatex=x("toLatex");e.prototype.toHorner=function(){function a(c,a){var b="";k&&c instanceof
k?0===c.im?(0<c.re&&a&&(b+="+"),b+=c.re):0===c.re?(-1===c.im?b+="-":1!==c.im?(0<c.im&&a&&(b+="+"),b+=c.im):0<c.im&&a&&(b+="+"),b+="i"):(a&&(b+="+"),b=b+"("+c.toString(),b+=")"):(0<c&&a&&(b+="+"),b+=c.toString());return b}function d(b,f){var e=b.length-f-1,h=b[e]-(b[e-1]||0),g="",k="";0<h&&(g="x",1<h&&(g+="^"+h));0<e&&(g+=a(c[b[e-1]],!0));if(0===f)return a(c[b[e]],!1)+g;0<=e&&b[e]&&(k+="(");k+=d(b,f-1);0<=e&&b[e]&&(k+=")");return k+g}var c=this.coeff,b=[],f;for(f in c)g.empty(c[f])||b.push(+f);if(0===
b.length)return"0";b.sort(function(c,a){return c-a});return d(b,b.length-1)};e.prototype.clone=function(){return new e(this)};e.prototype.degree=function(){return q(this.coeff)};e.setField=function(a){if("Q"===a)g={add:function(c,a){return(new m(c)).add(a)},sub:function(c,a){return(new m(c)).sub(a)},mul:function(c,a){return(new m(c)).mul(a)},div:function(c,a){return(new m(c)).div(a)},parse:function(c){return new m(c)},empty:function(c){return(new m(c)).equals(0)},pow:function(c,a){return(new m(c)).pow(a)}};
else if("C"===a)g={add:function(c,a){return(new k(c)).add(a)},sub:function(a,b){return(new k(a)).sub(b)},mul:function(a,b){return(new k(a)).mul(b)},div:function(a,b){return(new k(a)).div(b)},parse:function(a){return new k(a)},empty:function(a){return(new k(a)).equals(0)},pow:function(a,b){return(new k(a)).pow(b)}};else if("H"===a)g={add:function(a,b){return(new n(a)).add(b)},sub:function(a,b){return(new n(a)).sub(b)},mul:function(a,b){return(new n(a)).mul(b)},div:function(a,b){return(new n(a)).div(b)},
parse:function(a){return new n(a)},empty:function(a){return(new n(a)).equals(0)},pow:function(a,b){return(new n(a)).pow(b)}};else if(!a||"R"===a)g=C;else if("object"===typeof a)g=a;else if("Z"===a.charAt(0)){var d=+a.slice(1);g={add:function(a,b){return((a+b)%d+d)%d},sub:function(a,b){return((a-b)%d+d)%d},mul:function(a,b){return(a*b%d+d)%d},div:function(a,b){var c=b;for(var e=d,g=0,k=1,m=1,n=0;0!==c;){var p=e/c|0,q=e%c,r=g-m*p;p=k-n*p;e=c;c=q;g=m;k=n;m=r;n=p}c=[e,g,k];if(1!==c[0])throw"DIV/-";return(a*
c[1]%d+d)%d},parse:function(a){return parseInt(a,10)},empty:function(a){return void 0===a||0===a},pow:function(a,b){for(var c=1;0<b;a=(a*a%d+d)%d,b>>=1)b&1&&(c=(c*a%d+d)%d);return c}}}};if("function"===typeof define&&define.amd)define(["fraction.js","complex.js","quaternion"],function(a,d,c){m=a;k=d;n=c;return e});else if("object"===typeof exports){var m=require("fraction.js");var k=require("complex.js");var n=require("quaternion");module.exports=e}else m=t.Fraction,k=t.Complex,n=t.Quaternion,t.Polynomial=
e})(this);
